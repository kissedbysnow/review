**已格式化**

---

#### 例1

**某一系统进程的资源分配“瞬时状态”如下表所示：（2015、2017年考题）**

| 进程 | 最大需求矩阵(Max) | 已分配资源矩阵(Allocation) |   [Need]()    | 可用资源向量（Available） |
| :--: | :---------------: | :------------------------: | :-----------: | :-----------------------: |
|  P1  |       3 2 2       |           1 0 0            | **[2 2 2]()** |           1 1 2           |
|  P2  |       6 1 3       |           5 1 1            | **[1 0 2]()** |                           |
|  P3  |       3 1 4       |           2 1 1            | **[1 0 3]()** |                           |
|  P4  |       4 2 2       |           0 0 1            | **[4 2 1]()** |                           |

**试问：在当前状态下，若进程 P2 提出请求 Request2(1,0,1)，系统能否满足该进程的资源请求？请写初利用银行家算法判断的过程。如果系统将资源分配给该请求进程，请写出安全序列。**

__解：__

P2 请求资源，P1 发出请求向量 Request2(1,0,1)，系统按银行家算法进行检查：

1. Request2(1,0,1) <= Need2(1,0,2);

2. Request2(1,0,1) <= **Available**(1,1,2);

3. 系统可先假定可为 P2 分配资源，并修改 **Available** Allocation2 Need2 向量，由此形成的资源变化情况如下所示：

   | 进程 | 最大需求矩阵(Max) | 已分配资源矩阵(Allocation) |           [Need]()            | 可用资源向量（Available） |
   | :--: | :---------------: | :------------------------: | :---------------------------: | :-----------------------: |
   |  P1  |       3 2 2       |           1 0 0            |         **[2 2 2]()**         |  1 1 2 - 1 0 1 => 0 1 1   |
   |  P2  |       6 1 3       |   5 1 1 + 1 0 1 => 6 1 2   | 1 0 2 - 1 0 1=> **[0 0 1]()** |                           |
   |  P3  |       3 1 4       |           2 1 1            |         **[1 0 3]()**         |                           |
   |  P4  |       4 2 2       |           0 0 1            |         **[4 2 1]()**         |                           |

4. 利用安全性算法检验此时系统是否安全：

   | 进程 | Work  | Need  | Allocation | Work + Allocation | Finish |
   | :--: | :---: | :---: | :--------: | :---------------: | :----: |
   |  P2  | 0 1 1 | 0 0 1 |   6 1 2    |       6 2 3       |  true  |
   |  P1  | 6 2 3 | 2 2 2 |   1 0 0    |       7 2 3       |  true  |
   |  P3  | 7 2 3 | 1 0 3 |   2 1 1    |       9 3 4       |  true  |
   |  P4  | 9 3 4 | 4 2 1 |   0 0 1    |       9 3 5       |  true  |

   **安全序列：**{ P2, P1, P3, P4 }

   由所进行的安全性检查得知，可以找到一个安全序列 {---}，因此系统是安全的，可立即将 P2 所申请的资源给它

---

#### 例2：（2018年考题）

**T0 时刻系统状态：**

| 进程 | 最大资源需求量 MAX | 已分配资源量 Allocation | 系统剩余资源量 Available | Need  |
| :--: | :----------------: | :---------------------: | :----------------------: | :---: |
|  P1  |       5 5 9        |          2 1 2          |          2 3 3           | 3 4 7 |
|  P2  |       5 3 6        |          4 0 2          |                          | 1 3 4 |
|  P3  |       4 0 11       |          4 0 5          |                          | 0 0 6 |
|  P4  |       4 2 5        |          2 0 4          |                          | 2 2 1 |
|  P5  |       4 2 4        |          3 1 4          |                          | 1 1 0 |

1. **T0 时刻是否为安全状态？若是，请给出安全序列**

   T0 时刻为安全时刻

   | 进程 |  Work   | Need  | Allocation | Work + Allocation | Finish |
   | :--: | :-----: | :---: | :--------: | :---------------: | :----: |
   |  P4  |  2 3 3  | 2 2 1 |   2 0 4    |       4 3 7       |  true  |
   |  P2  |  4 3 7  | 1 3 4 |   4 0 2    |       8 3 9       |  true  |
   |  P3  |  8 3 9  | 0 0 6 |   4 0 5    |      12 3 14      |  true  |
   |  P5  | 12 3 14 | 1 1 0 |   3 1 4    |      15 4 18      |  true  |
   |  P1  | 15 4 18 | 3 4 7 |   2 1 2    |      17 5 20      |  true  |

   **安全序列：**{ P4, P2, P3, P5,P1 }

2. **若进程 P4 请求资源（2，0，1），能否实现资源分配？为什么？**

   P4 请求资源，发出请求向量 Request4(2,0,1)，系统按银行家算法进行检查

   1. Request4(2,0,1) <= Need4(2,2,1)

   2. Request4(2,0,1) <= **Available**(2,3,3)

   3. 系统可先假定为 P4 分配资源，并修改 **Available** Allocation4 Need4 向量，由此形成的资源变化情况如下所示：

      | 进程 |  MAX   |  已分配资源量 Allocation  | 系统剩余资源量 Available  |           Need            |
      | :--: | :----: | :-----------------------: | :-----------------------: | :-----------------------: |
      |  P1  | 5 5 9  |           2 1 2           | 2 3 3 - 2 0 1 = [0 3 2]() |           3 4 7           |
      |  P2  | 5 3 6  |           4 0 2           |                           |           1 3 4           |
      |  P3  | 4 0 11 |           4 0 5           |                           |           0 0 6           |
      |  P4  | 4 2 5  | 2 0 4 + 2 0 1 = [4 0 5]() |                           | 2 2 1 - 2 0 1 = [0 2 0]() |
      |  P5  | 4 2 4  |           3 1 4           |                           |           1 1 0           |

   4. 利用安全性算法检验此时系统是否安全：

      | 进程 | Work    | Need  | Allocation | 新Work  | Finish |
      | ---- | ------- | ----- | ---------- | ------- | ------ |
      | P4   | 0 3 2   | 0 2 0 | 4 0 5      | 4 3 7   | true   |
      | P2   | 4 3 7   | 1 3 4 | 4 0 2      | 8 3 9   | true   |
      | P3   | 8 3 9   | 0 0 6 | 4 0 5      | 12 3 14 | true   |
      | P5   | 12 3 14 | 1 1 0 | 3 1 4      | 15 4 18 | true   |
      | P1   | 15 4 18 | 3 4 7 | 2 1 2      | 17 5 20 | true   |

      可以实现资源分配，因为分配之后系统还是安全的

3. **在 2. 的基础上，若进程 P1 请求资源（0,2,0），能否实现资源分配？为什么？**

   Request2(0,2,0) <= Need2(1,3,4)

​       Request2(0,2,0) <= **Available**(0,3,2)

​      分配资源后系统将处于不安全状态，所以不能实现资源分配。

***

#### 例3

Consider the following snapshot of a system: