# 农科驿站

## 一、可行性研究

可行性分析(FeasibilityAnalysis)，即可行性研究，它是针对新系统的开发是不是具备必可能性和必要性并基于对系统的调查，对新系统的开发从技术、社会和经济等方面开展分析和研究工作，以避免投资失误，从而保障新系统的开发成功。可行性研究的目标是用最小的代价在尽量短的时间内确定问题是否可以得到解决。其实质上是要进行一次大大压缩简化了的系统分析和设计过程，即以较抽象的方式在较高层次上进行的系统分析和设计的过程。

### 1.1 技术可行性分析

本系统是一个前后端分离的项目，前端基于Vue + iView-Admin + Vue-Router + Vuex + Axio，后端基于 SpringBoot + Shiro + Mybatis + Mybatis-Plus + HikariCP + Redis + Vue + iView 等轻量级管理系统快速开发脚手架，拥有角色、用户、资源管理、权限数据同步更新等功能。

普通计算机硬件配置即可满足开发要求，页面 UI 设计使用软件 Axure RP，前端开发软件使用 JetBrains WebStorm，后端开发软件使用 IntelliJ IDEA，数据库使用 MySQL，版本控制软件使用 Git。 

以下软件功能全面版本稳定，是目前主流开发模式所使用的。足够满足系统的需求。

#### 1.1.1 后端技术

| **技术**           | **类型**      | **版本**       | **官网**                                                     |
| ------------------ | ------------- | -------------- | ------------------------------------------------------------ |
| Spring Boot        | 容器          | 1.5.12.RELEASE | http://start.spring.io/                                      |
| Mybatis-Starter    | ORM框架       | 1.3.1          | http://www.mybatis.org                                       |
| Mybatis-Plus       | ORM框架       | 1.3.1          | http://mp.baomidou.com/                                      |
| Maven              | 项目构建管理  | 3.6            | [http://maven.apache.org](http://maven.apache.org/)          |
| Apache Shiro       | 安全框架      | 1.3.2          | [http://shiro.apache.org](http://www.mybatis.org/generator/index.html) |
| Lombok             | 工具          | 1.16.20        | https://www.projectlombok.org/                               |
| HikariCP           | 数据库连接池  | 2.7.8          | http://brettwooldridge.github.io/HikariCP/                   |
| Shiro-Redis        | shiro缓存工具 | 2.8.24         | https://github.com/alexxiyang/shiro-redis                    |
| Springfox-Swagger2 | api文档工具   | 2.7.0          | https://github.com/springfox/springfox                       |
| jedis              | redis管理     | 2.9.0          | https://github.com/xetorthio/jedis                           |
| jwt                | 身份认证      | 3.2.0          | https://jwt.io/                                              |

#### 1.1.2 前端技术

| **技术**                 | **类型**       | **版本** | **官网**                                               |
| ------------------------ | -------------- | -------- | ------------------------------------------------------ |
| Vue                      | 前端渐进式框架 | 2.5.13   | https://cn.vuejs.org/                                  |
| Vue-Router               | 前端路由       | 3.0.1    | https://router.vuejs.org/                              |
| Vuex                     | 前端状态管理   | 3.0.1    | https://vuex.vuejs.org/                                |
| Axios                    | HTTP库         | 0.18.0   | https://github.com/axios/axios                         |
| iView                    | UI框架         | 2.8.0    | https://www.iviewui.com/                               |
| dayjs                    | JS时间操作库   | 1.5.14   | https://github.com/xx45/dayjs                          |
| String-Format            | 字符串格式化   | 1.0.0    | https://github.com/davidchambers/string-format         |
| Vue-table-with-tree-grid | iview-树表格   | 0.2.4    | https://github.com/MisterTaki/vue-table-with-tree-grid |
| js-md5                   | js-md5库       | 0.7.3    | https://github.com/emn178/js-md5                       |

### 1.2 经济可行性分析

1. 本系统由省科技厅牵头，经济上有保障。

2. 硬件环境借助青岛农业大学服务器，分别为：一台静态资源文件管理服务器，一台前端程序服务器，一台后端程序服务器。以上是采用分布式部署，若资源紧张也可改为一台服务器部署。

3. 软件环境：JDK8.0+、Maven、Redis、Vue、Nginx、Axure RP、JetBrains WebStorm、IntelliJ IDEA、MySQL、Git等均可从网上获取并以学生身份免费使用，极大的降低了开发成本。

4. 农科驿站作为山东省农业科技服务体系的重要组成部分，是农业与农村科技信息传播的中继站，完成上传下达职能，打通农业科技最后一公里，承担着农业科技推广与示范的重要作用。可为遍布全省的工作站的农业科技服务工作开展提供一个有效的宣传、管理与支撑平台。

### 1.3 操作可行性分析

主要实现对全省农科驿站的注册、备案、审核、绩效考评、日常活动管理等功能。

## 二、需求规格说明

在开发任何一个系统之前，进行必需的系统分析是非常有必要的，主要是根据对客户的需求和本系统的一些特点和模块的分析等来确定如何有效地进行实际的开发。需求分析是软件设计的一个重要组成部分。为了确定系统的目标，应在本阶段对系统的应用情况进行全面的调查。

### 2.1 功能性需求分析

#### 2.1.1系统用户

1. 超级管理员/系统管理员；

2. 政府管理员：

3. 工作站管理员；

4. 注册用户：分为专家用户、个人用户和企业用户；

5. 普通用户（游客）。

#### 2.1.2 用户功能

- 超级管理员/系统管理员功能
  - 具有所有权限。
  - 管理管理员，上级管理员可以管理下级管理员
-  政府管理员功能
  - 工作审核，政府管理员可对辖区内农科驿站的工作日志进行审核，审核通过后可在前台展示。
  - 驿站管理，政府管理员可对辖区内农科驿站进行增删改查。
  - 驿站人员管理，对辖区内农科驿站的人员具有所有权限。
- 工作站管理员
  - 驿站管理，管理员可以对驿站内容进行修改。
- 注册用户
  - 驿站维护，注册用户可以维护所属的驿站。

- 普通用户

### 2.2 功能性需求分析

#### 2.2.1 系统安全性需求

在软件使用方面，所有使用者统一使用 Shiro 权限验证核验身份后进入系统。用户、角色和权限分别对应。

#### 2.2.2 系统开发运行环境需求

- JDK：作为整个Java的核心包含了Java的基础类库、运行环境和Java工具，是 Java 语言的软件开发工具包。

- MyEclipse：是一个非常杰出的Java开发工具，对各种开源产品的支持非常好。它不仅功能非常强大，而且具备非常广泛的支持性能。

- Tomcat服务器：适用于中小型系统开发的web应用服务器，开放源代码且免费。其性能稳定、技术先进，因此不但博得了Java 开发人员的喜爱，而且也得到了一些软件开发商的肯定，是当今较流行的Web 应用服务器。

- MySQL数据库：是目前小型应用开发中比较流行的数据库，且从MySQL5.0版本开始支持事务，保证了数据库的完整性和安全性。

- Spring Boot是由Pivotal团队提供的全新框架，其设计目的是用来简化新Spring应用的初始搭建以及开发过程。该框架使用了特定的方式来进行配置，从而使开发人员不再需要定义样板化的配置。通过这种方式，Spring Boot致力于在蓬勃发展的快速应用开发领域(rapid application development)成为领导者。

- Vue (读音 /vjuː/，类似于 view) 是一套用于构建用户界面的渐进式JavaScript框架。与其它大型框架不同的是，Vue 被设计为可以自底向上逐层应用。Vue 的核心库只关注视图层，方便与第三方库或既有项目整合。

- Apache Shiro（读作“sheeroh”，即日语“城”）是一个开源安全框架，提供身份验证、授权、密码学和会话管理。Shiro框架直观、易用，同时也能提供健壮的安全性。

- Redis（Remote Dictionary Server )，即远程字典服务，是一个开源的使用ANSI C语言编写、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。

- Maven项目对象模型(POM)，可以通过一小段描述信息来管理项目的构建，报告和文档的项目管理工具软件。

  Maven 除了以程序构建能力为特色之外，还提供高级项目管理工具。由于 Maven 的缺省构建规则有较高的可重用性，所以常常用两三行 Maven 构建脚本就可以构建简单的项目。由于 Maven 的面向项目的方法，许多 Apache Jakarta 项目发文时使用 Maven，而且公司项目采用 Maven 的比例在持续增长。

## 三、总体设计说明

总体设计，也可以称为概要设计或者初步设计，其基本目的便是回答“概括地说，应当如何实现系统”这个问题。经过这个阶段，将划分出构成系统的物理元素（数据库、程序、文件、文档和人工过程等），然而所有的物理元素依旧处于黑盒子级，这些黑盒子里的具体内容将在之后进行详细的设计。总体设计阶段的另外一项重要任务是确定系统中的每一个程序由哪些模块构成以及这些模块相互之间的关系，即设计软件的结构。

### 3.1 项目规划

总体规划：农科驿站是一个非常典型的前后端分离项目，它由前端展示页面模块、后台数据管理模块和静态资源服务器三大模块构成。

- 前端页面提供身份登录接口，验证交由后端处理。驿站的各项操作，活动的申请，附件的上传下载等。

- 后端进行数据库的管理和维护，所有的文本信息都交由后端处理并存储。

- 静态资源服务器负责存储发布文件、视频、文档、图片等静态资源。

### 3.2 系统总体结构 

系统总体结构是系统总体设计的核心部分，通过系统结构图可以很清楚地看出整个系统的结构。根据各个结构模块分别进行分析，从而为将来的设计和实现打下良好的基础。根据前面对系统所做出的分析，本系统总体上包括5类用户。系统总体结构如下图所示。

![image-20200427233330382](../qnit/cloud-workstation.wiki/2系统设计/images/image-20200427233330382.png)

![yongli-v0.2](../qnit/cloud-workstation.wiki/2系统设计/images/yongli-v0.2.png)

### 3.3 系统功能模块

农科驿站系统根据用户的类别共分成三个模块：普通用户模块、专家用户模块和管理员模块。

![image-20200427230316111](../qnit/cloud-workstation.wiki/2系统设计/images/image-20200427230316111.png)

#### 3.3.1 用户模块定义

| **功能模块** | **定义**                       |
| ------------ | ------------------------------ |
| **注册用户** | **用于注册用户信息**           |
| **用户登录** | **用于用户登录系统的身份验证** |
| **修改资料** | **用于用户修改个人资料**       |
| **搜索资源** | **用于用户搜索所有的资源**     |

#### 3.3.2 专家模块定义

| **功能模块**     | **定义**                       |
| ---------------- | ------------------------------ |
| **注册用户**     | **用于注册用户信息**           |
| **用户登录**     | **用于用户登录系统的身份验证** |
| **修改资料**     | **用于用户修改个人资料**       |
| **搜索资源**     | **用于用户搜索所有的资源**     |
| **上传知识科普** | **用于专家用户上传科普**       |

#### 3.3.3 管理员模块定义

| **功能模块**           | **定义**                                 |
| ---------------------- | ---------------------------------------- |
| **驿站负责人登录**     | **用于驿站负责人登录系统的身份验证**     |
| **县科技局管理员登录** | **用于县科技局管理员登录系统的身份验证** |
| **市科技局管理员登录** | **用于市科技局管理员登录系统的身份验证** |
| **省科技局管理员登录** | **用于省科技局管理员登录系统的身份验证** |
| **驿站管理**           | **用于管理驿站的日常事务**               |
| **驿站日志**           | **用于编写驿站的情况**                   |

## 四、详细设计说明书

通过这一阶段的工作进行了详细的设计，我们将会确切地描述所要开发的目标系统，其基本任务是要确定能够具体地实现所要求的系统的方法途径。

### 4.1 界面设计

对于任何系统来讲，设计用户界面都是相当重要的。因为一个交互良好的界面不仅可以使浏览者对系统的印象更深刻，而且可以为与客户进行沟通提供方便。

本系统的界面使用vue页面来实现，并采用DIV+CSS技术对界面进行美化。
在页面的实现过程中，主要遵循了以下两个原则：

1. 统一连贯。页面的整体风格要与自己所要表达的内容相符，本系统是在线答疑系统，采用草绿色为界面的颜色基调，能凸显学生的活力和知识学习生机勃勃的景象。
2. 布局合理、和谐。整个页面要符合大众人群的审美观念。布局是一个页面显示的主体框架，一个设计良好的布局，能给用户很好的使用效果和深刻的浏览记忆。

本系统的主界面如下图所示。

![fdsa](../fdsa.jpg)

### 4.2 系统分层的实现

根据MVC设计思想，本系统以SpringBoot框架为控制器，用来管理各页面传过来的请求，从而发给相应的action处理；

各vue页面作为动态页面表示层来进行显示；MybatisPlus和各个Action等均作为Spring当中的受管Bean。

#### 4.2.1 表现层的设计
所有样式，都会在 src/style/ 文件夹中对应的位置去写。我这样做的好处是，不需要重复的引入各种 scss 基础文件，并且做到了项目的样式代码的可管控。

#### 4.2.2 控制层的设计
控制层的采用的是SpringBoot框架。因为能够使用SpringBoot的控件上传文件，并且其拦截器机制也能够对特定信息进行拦截。该系统中SpringBoot的工作原理体现如下：当用户从前台页面选择操作后，通过SpringBoot控制器转发给相应的action进行处理，各action通过Spring的依赖注入的MybatisPlus来实现对数据库的各项操作，最后将得到的数据传到页面进行显示。

### 4.3 各个功能模块的设计与实现

根据系统分析和系统的总体设计，基本确定了该系统所包含的模块，下面具体介绍各个模块的基本功能的设计与实现。

#### 4.3.1 用户登录和注册

依据系统分析和功能的需求，用户在没有登录的情形下，除了对系统首页进行浏览外无法执行其它操作。只有在登陆成功的情况下，才能够发表疑问和回复并执行其它操作。普通用户和管理员通过系统首页登录系统。
在利用SpringBoot框架进行开发的过程中，有时一个动作要与一个Action对应，可是这些Action中有些属性或方法是通用的，倘若在每一个Action里面反复书写相同的属性或方法就会导致代码看起来不仅冗长并且枯燥。因此，首先要定义一个可以让之后的所有Action继承的一个包含通用属性和方法的基类Action，即BaseAction类。其具体实现类是DYBaseAction。

1. 用户注册

   用户通过系统首页进入注册页面，因为注册的用户有很多，本模块使用了Ajax异步交互技术，在客户端还未提交注册表之前可以对信息进行验证，倘若注册信息不符合要求则禁止提交，这样不但使得网络流量在很大程度上得到减少，而且也使得服务器的负担得到极大的减轻。
   采用Ajax技术向服务器发送异步请求，在创建好XmlHttpRequest对象后要获取用户注册时所填写的用户名，而后再把验证请求发送到服务器端。

2. 用户登录

   - 普通用户和管理员用户通过系统主页登录。

#### 4.3.2 普通用户模块

普通用户成功登录系统后，主页面显示了工作站基本信息（包含工作站位置GIS显示，覆盖地域、人囗、地域特点、特产、产量、服务对象、运营主体、联系方式）、名优土特产、地标产品、视频简介等。

#### 4.3.4 管理员模块
管理员分为普通管理员和超级管理员，普通管理与与超级管理员相比只是少了对管理员进行管理的权限。接下来以超级管理员为例来描述管理员模块的详细设计与实现。管理员成功登录系统后进入系统的在线管理中心。

## 五、数据库设计及测试设计说明

### 5.1 数据库设计

数据库技术是管理信息资源的最佳方式。数据库设计是针对一个特定的应用环境构造出最优的数据库模式来创建数据库及其应用系统，从而实现对数据的有效存储，以满足用户对信息和处理的要求。数据库结构的设计将直接影响到应用系统的效率和实现的效果。因此，合理的数据库设计不但能够提升数据存储的效率，而且可以有效的确保数据的完整性和一致性。

确定了系统需要开发的功能之后，接下来应该进行数据库的设计工作，分析该系统的各个实体之间的关系，做好数据库的设计对后期的开发有着非常重要的作用。

#### 5.1.1 数据库分析

由于本系统的规模不是很大，因此选用MySQL数据库，该数据库为开源免费产品，可以直接通过网上下载得到，从而大大节约了开发成本。MySQL数据库是现今小型应用开发中比较流行的数据库，且从其5.0版本开始支持事务，能够确保数据的完整性和安全性。

#### 5.1.2 项目E-R图

农科驿站作为驿站人员和科技局之间沟通交流的桥梁，所包含的实体有提交驿站申请、驿站详情、驿站活动、驿站备案、驿站管理、附件上传、绩效考核。下面将依次介绍各个实体所对应的E-R图。

- 驿站详情
- 驿站活动
- 附件上传
- 人员信息
- 地区编码

#### 5.1.3 数据库表的设计

系统数据库设计的好坏不仅对今后网站连接数据库的速度有着非常重要的影响，而且也对查询更新的复杂度有着非常重要的影响。本节介绍对本系统的数据库表进行的设计，是在完成系统功能分析的基础上根据系统的需求目标而进行的设计。根据前面所介绍的实体所拥有的属性以及实体之间的关系描述，下面将介绍数据库中这些实体对应的表的设计，具体设计如下所示。



### 5.2 系统各个功能点的测试

1. 添加功能：关于添加功能主要测试以下几方面：
   1. 关于必填项的测试
   2. 关于唯一性的测试
   3. 关于输入项长度的测试
   4. 关于输入内容限制的测试
   5. 其它方面的测试
2.  修改功能
3. 删除功能
4. 查询功能
5. 翻页功能
6. 导入、导出、上传文件
7. ………… 

测试内容较多，该部分仅以关于某模块输入项长度的测试为例。

关于输入项长度的测试
电话号码长度（系统规定该长度为11位）

| 序号 | 测试号码长度 | 测试用例      | 输出结果                     |
| ---- | ------------ | ------------- | ---------------------------- |
| 1    | 7            | 5223612       | 注册失败，电话号码不符合规范 |
| 2    | 9            | 871230342     | 注册失败，电话号码不符合规范 |
| 3    | 11           | 55344342421   | 注册成功                     |
| 4    | 13           | 5420124825240 | 注册失败，电话号码不符合规范 |

密码长度（系统规定密码长度最小为 6 位，最大为 10 位）

| 测试用例序号 | 密码输入长度 | 测试用例    | 输出结果           |
| ------------ | ------------ | ----------- | ------------------ |
| 1            | 5            | 123gf       | 注册失败，密码过短 |
| 2            | 6            | 6rd7t9      | 注册成功           |
| 3            | 8            | 4542876g    | 注册成功           |
| 4            | 10           | Fgh7621fd0  | 注册成功           |
| 5            | 11           | 78jhhvbh547 | 注册失败，密码过长 |